#Drone CI File.1
kind: pipeline
type: ssh
name: default
server:
  host: 15.207.116.55
  user: 
    from_secret: docker_username
  password:
    from_secret: docker_password
steps:
- name: build
  commands:
  - cd myapp
  - /opt/maven/bin/mvn clean install
- name: publish
  commands:
      #Download the JFrog CLI 
      - curl -fL https://getcli.jfrog.io | sh
      - chmod +x ./jfrog
      - apikey=eyJ2ZXIiOiIyIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYiLCJraWQiOiJaSktQZ3laVEx6eWgwRktFQjRUeWlIRWhuWlRSTDZOQXZfZHJxSUhzMjJnIn0.eyJleHQiOiJ7XCJyZXZvY2FibGVcIjpcInRydWVcIn0iLCJzdWIiOiJqZmFjQDAxZnIxZ3RwanlwaHQ4MDIwZXA2ZHAwNHcwXC91c2Vyc1wvZ29wYWx2Iiwic2NwIjoiYXBwbGllZC1wZXJtaXNzaW9uc1wvYWRtaW4iLCJhdWQiOiIqQCoiLCJpc3MiOiJqZmZlQDAwMCIsImV4cCI6MTY3MjMwNjYyMiwiaWF0IjoxNjQwNzcwNjIyLCJqdGkiOiI4ZDVlNmVjYy0wODIzLTRmMTUtYWQ3OS1jYTU2NmJkNzY4OTMifQ.G6gqqIZpeHUFuEsy1N71iuKSS4D9TIGIDJWlG1IY_GZxRiJ9x9M5ljT0va-MpSaMDAPYX3jYPPabJVne_0OsJhCEqx0vcsdTd3x-jtt71CQbiCyqnjB4nq0mupMG5NzzWCOlYxhxIPQrkMP6hMi2njDvJwC2Yb9IPUGiTZNTyp3ovr5FG_uZLeCtl6ZX3GCZa00T0pGJJegkcXkTneOXjK4LrMVVFnb2mt0jXjj6PKus8HUzXjh0_tvqvTn5C9OicBpLe_Z0N8l9jCTCjmlCo3qV9A_66HBaZu-epsaE2VhfWmRWlV_XWpKeseIPkYu0KDxE-dHLSSfINeQ4gnsLtA
      - ./jfrog rt u --url=https://gopalv.jfrog.io/artifactory/default-maven-local/ --access-token=$apikey myapp/target/myapp-0.1.war maven/sample/myapp-0.1.war
